extend ../default2
block mainContent

	.header
		.shineheader
		h1.headertext.headertextmat matsedel
	.matdagar
	//- //p.hej
	//- .dag
	//- 	p.veckodag Tisdag
	//- 	p.meny.huvudratt Ekologisk pasta med strimlat nötkött, champinjoner och grädde
	//- 	p.meny.vegratt Tofu- och grönsaker tikka masala serveras med ekologiskt ris


	script.
		_('.main-content').style.maxWidth = 'none'


		api.food(function(err, weeks) {
			if (err) return (function foodLoadingError(err) {
				// TODO: Show in UI
				console.error({api:'food', err:err})})()
			
			var currentWeekNr = (new Date()).getWeek()
			var currentDayOfWeek = (new Date()).getDay()
			weeks.forEach(function(week) {
				if (week.nr<currentWeekNr) return;
				if (week.nr>currentWeekNr+1) return;
				var isCurrentWeek = currentWeekNr==week.nr

				if (!isCurrentWeek) {
					temp = document.createElement('div')
					temp.className ="day nextWeek"
					_(".matdagar").appendChild(temp)

					text = document.createElement('p')
					text.className = "veckodag"
					temp.appendChild(text)
					text.innerHTML = week.nr==currentWeekNr+1? "Nästa vecka": "Vecka "+week.nr
				}

				week.days.forEach(function(day) {
					var isCurrentDay = currentDayOfWeek==day.nr

					temp = document.createElement('div')
					temp.className ="day"
					_(".matdagar").appendChild(temp)

					text = document.createElement('p')
					text.className = "veckodag"
					temp.appendChild(text)
					text.innerHTML = day.name

					textreg = document.createElement('p')
					textreg.className = "meny huvudratt"
					textreg.innerText = day.courses.main
					temp.appendChild(textreg)

					textveg = document.createElement('p')
					textveg.className = "meny vegratt"
					textveg.innerText = '☘ ' + day.courses.veg//✿
					temp.appendChild(textveg)

					if (isCurrentDay && isCurrentWeek) {
						[temp,text,textreg,textveg].forEach(function(el) {
							el.className += " today" })
					}

					//- if (i == arr.length -1 && !any){
					//- 	var divs = document.querySelectorAll('.veckodag'), e;
					//- 	for (e = 0; e < divs.length; ++e) {
					//- 		divs[e].style.color = "black";
					//- 	}
					//- 	var divs2 = document.querySelectorAll('.meny'), f;
					//- 	for (f = 0; f < divs.length; ++f) {
					//- 		divs2[f].style.color = "black";
					//- 	}
					//- }

				})
			})
		})



		